/**************************************************************** *  文件名     ： WeightChangeNoticeWorker.java *  日期         :  2012-12-28 *  Company: 上海绿岸网络科技有限公司 *  (C) Copyright Green Shore Network Technology Co.,Ltd.2012 *           		All Rights Reserved. *  注意： 本内容仅限于上海绿岸网络科技有限公司内部使用，禁止转发 ****************************************************************/package com.iwgame.xengine.xtask.email.worker.notification;import javax.annotation.Resource;import net.sf.json.JSONObject;import org.apache.log4j.Logger;import com.iwgame.xengine.xtask.email.cache.WeightModelCache;import com.iwgame.xengine.xtask.email.tools.calc.WeightCalculation;/** * @类名: WeightChangeNoticeWorker * @描述: *  * @作者: 吴君杰 * @邮件: wujunjie@iwgame.com * @日期: 2012-12-28下午6:25:17 * @版本: 1.0 */public class WeightChangeNoticeWorker {	@Resource	private WeightModelCache weightModelCache;	@Resource	private WeightCalculation weightCalculation;	private final Logger logger = Logger.getLogger(WeightModelCache.class);	public void handleMessage(String source) {		logger.info("收到邮件通道[配置变更]请求:" + source);		try {			JSONObject message = JSONObject.fromObject(source);			int chanenl_id = message.getInt("channelid");			int optype = message.getInt("optype");			switch (optype) {			case 1:				weightModelCache.changeWeightModelsByChanenlid(chanenl_id);				weightCalculation.setWeightForZoreByChannelid(chanenl_id);				break;			case 2:				weightModelCache.removeAllWeightModelsCache();				weightCalculation.setWeightAllForZore();				break;			}		} catch (Exception e) {			logger.error("邮件通道[配置变更]失败,请检查!异常信息:", e);		}	}}